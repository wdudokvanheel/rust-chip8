<!DOCTYPE html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
	<style>
		html, body {
			margin: 0px;
			padding: 0px;
			width: 100%;
			height: 100%;
			background: #1d1d1d;
			padding: env(safe-area-inset);
		}

		canvas {
			position: fixed;
			display: block;
			padding: 0px;
			margin: 0px;
		}
	</style>

	<script type="module">
		import {default as init, WasmRuntime} from './chip8.js';

		let runtime = undefined;
		let callback = undefined;

		function reset() {
			if(callback != undefined) {
				callback.reset();
			}
		}

		async function start() {
			await init('./chip8_bg.wasm');
			return new WasmRuntime();
		}

		start().then(value => {
			runtime = value
			callback = runtime.get_sender();
			runtime.start();
		});

		const canvas = document.getElementById("canvas");

		canvas.addEventListener('contextmenu', function (e) {
			e.preventDefault();
		});


		document.addEventListener("DOMContentLoaded", function () {
			const resetButton = document.getElementById("reset");
			resetButton.addEventListener("click", reset);
		});

	</script>
</head>
<body>
	<div>
		<button id="reset">
			Reset
		</button>
	</div>
	<div>
		<canvas id="canvas"></canvas>
	</div>
</body>
<html>
